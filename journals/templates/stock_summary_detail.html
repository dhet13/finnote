{% extends "base.html" %}

{% block feed %}
<style>
    .journal-container { padding: 20px; max-width: 800px; margin: auto; }
    .header-section { margin-bottom: 24px; border-bottom: 2px solid #f0f0f0; padding-bottom: 16px; }
    .header-section h1 { font-size: 2rem; color: #333; margin-bottom: 8px; }
    .header-section p { font-size: 1rem; color: #666; }
    .journal-card { background-color: #fff; border: 1px solid #eee; border-radius: 8px; padding: 20px; margin-bottom: 16px; text-decoration: none; color: inherit; display: block; }
    .journal-card:hover { border-color: #ccc; }
    .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
    .card-title { font-size: 1.2rem; font-weight: bold; }
    .card-meta { font-size: 0.85rem; color: #666; }
    .card-content { font-size: 0.95rem; color: #555; margin-bottom: 12px; }
    .stats-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-top: 12px; }
    .stat-box { background-color: #f9f9f9; border-radius: 4px; padding: 10px; text-align: center; }
    .stat-label { font-size: 0.75rem; color: #777; margin-bottom: 4px; }
    .stat-value { font-size: 1.1rem; font-weight: 500; }
    .pnl-positive { color: #28a745 !important; }
    .pnl-negative { color: #dc3545 !important; }
</style>

<div class="journal-container">
    <div class="header-section">
        <h1>{{ stock_name }} ({{ ticker_symbol }}) 매매일지</h1>
        <p>이 페이지에서는 {{ stock_name }} 종목에 대한 모든 개별 매매일지를 확인할 수 있습니다.</p>
    </div>

    <div class="journal-list">
        {% if stock_journals %}
            {% for journal in stock_journals %}
                <a href="{% url 'journals:stock_detail' journal.pk %}" class="journal-card">
                    <div class="card-header">
                        <span class="card-title">매매일지 #{{ forloop.counter }}</span>
                        <span class="card-meta">{{ journal.created_at|date:"Y년 m월 d일" }}</span>
                    </div>
                    <div class="card-content">
                        <p><strong>목표가:</strong> {{ journal.target_price|floatformat:2 }}</p>
                        <p><strong>손절가:</strong> {{ journal.stop_price|floatformat:2 }}</p>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-box">
                            <div class="stat-label">평균 매수가</div>
                            <div class="stat-value">{{ journal.avg_buy_price|floatformat:2|default:"-" }}</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">평균 매도가</div>
                            <div class="stat-value">{{ journal.avg_sell_price|floatformat:2|default:"-" }}</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">실현 손익</div>
                            <div class="stat-value {% if journal.realized_pnl > 0 %}pnl-positive{% elif journal.realized_pnl < 0 %}pnl-negative{% endif %}">
                                {% if journal.realized_pnl is not None %}
                                    {{ journal.realized_pnl|floatformat:2 }}
                                {% else %}
                                    —
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </a>
            {% endfor %}
        {% else %}
            <p>{{ stock_name }} ({{ ticker_symbol }})에 대한 매매일지가 없습니다.</p>
        {% endif %}
    </div>
</div>
{% endblock %}